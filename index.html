<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>æ­¡è¿é é¢èˆ‡å¤©æ°£ç¤ºç¯„</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <div id="welcome">æ­¡è¿ä¾†åˆ°Ping Hsuçš„ç¶²ç«™ï¼</div>
  <div id="goodWords">ä»Šå¤©æ˜¯ç¾å¥½çš„ä¸€å¤©ï¼Œé¡˜ä½ å¿ƒæƒ…æ„‰å¿«ï¼ğŸŒ</div>
  <div id="weather">æ­£åœ¨è¼‰å…¥å¤©æ°£è³‡è¨Š...</div>

  <p id="message"></p>

  <button class="btn btn-gradient" onclick="open104Home()">å‰å¾€ 104</button>
  <button class="btn btn-red" onclick="openPingHsu104()">å‰å¾€ PingHsu's 104</button>
  <button class="btn btn-green" onclick="openLinkedIn()">å‰å¾€ LinkedIn</button>
  <button class="btn btn-yellow" onclick="openLinkedInPingHsu()">å‰å¾€ PingHsu's LinkedIn</button>
  <button class="btn btn-brown" onclick="openNotion()">å‰å¾€ Notion</button>

<script>
async function loadWeather() {
  try {
    // ä½¿ç”¨ ip-api.com å–å¾—åœ°ç†åº§æ¨™
    let r1 = await fetch('http://ip-api.com/json/?fields=status,message,city,lat,lon');
    let geo = await r1.json();
    if (geo.status !== 'success') {
      throw new Error(geo.message || 'å®šä½å¤±æ•—');
    }
    const {city, lat, lon} = geo;

    // ä½¿ç”¨ Openâ€‘Meteo å…è²»å¤©æ°£ API å–å¾—ç•¶å‰å¤©æ°£
    let r2 = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
    let weather = await r2.json();

    if (weather.current_weather) {
      const temp = weather.current_weather.temperature;
      const code = weather.current_weather.weathercode;
      const text = weatherCodeToText(code);
      document.getElementById('weather').textContent = `ç›®å‰ä½ç½®ï¼š${city}ï¼Œæº«åº¦ç´„ ${temp}Â°Cï¼Œå¤©æ°£ï¼š${text}`;
    } else {
      throw new Error('å¤©æ°£æ ¼å¼éŒ¯èª¤');
    }
  } catch (e) {
    console.error(e);
    document.getElementById('weather').textContent = 'è¼‰å…¥å¤©æ°£æ™‚ç™¼ç”ŸéŒ¯èª¤ï¼š' + e.message;
  }
}

function weatherCodeToText(c) {
  const m = {
    0:'æ™´æœ—',1:'ä¸»è¦æ™´æœ—',2:'éƒ¨åˆ†å¤šé›²',3:'å¤šé›²',45:'è–„éœ§',48:'éœ§å‡‡',
    51:'è¼•å¾®æ¯›æ¯›é›¨',53:'ä¸­åº¦æ¯›æ¯›é›¨',55:'æ¿ƒæ¯›æ¯›é›¨',
    61:'å°é›¨',63:'ä¸­é›¨',65:'å¤§é›¨',
    80:'å°é›¨é™£é›¨',81:'ä¸­é›¨é™£é›¨',82:'å¤§é›¨é™£é›¨',
    95:'é›·é›¨',96:'è¼•å¾®é›·é›¨å¸¶å†°é›¹',99:'å¼·é›·é›¨å¸¶å†°é›¹'
  };
  return m[c] || 'æœªçŸ¥å¤©æ°£';
}

window.onload = loadWeather;

// æ³¨æ„å‰é¢æ•´åˆçš„æŒ‰éˆ•å‡½å¼èˆ‡è¨Šæ¯é¡¯ç¤º
function showMessage(text) {
  document.getElementById('message').textContent = text;
}
function open104Home() {
  showMessage('Button clicked: å‰å¾€ 104');
  window.open('https://www.104.com.tw','_blank','noopener,noreferrer');
}
function openPingHsu104() {
  showMessage('Button clicked: å‰å¾€ PingHsu\'s 104');
  window.open('https://www.104.com.tw/jobbank/...','_blank','noopener,noreferrer');
}
function openLinkedIn() {
  showMessage('Button clicked: å‰å¾€ LinkedIn');
  window.open('https://www.linkedin.com/','_blank','noopener,noreferrer');
}
function openLinkedInPingHsu() {
  showMessage('Button clicked: å‰å¾€ PingHsu\'s LinkedIn');
  window.open('https://www.linkedin.com/in/ping-h-32b485104/','_blank','noopener,noreferrer');
}
function openNotion() {
  showMessage('Button clicked: å‰å¾€ Notion');
  window.open('https://www.notion.com/zh-tw/personal','_blank','noopener,noreferrer');
}
</script>
</body>
</html>
